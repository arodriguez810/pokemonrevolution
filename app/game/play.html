<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta content=" initial-scale=0.899, maximum-scale=0.899, user-scalable=no" name="viewport">
    <title>Pokemon Revolution</title>
    <link rel="icon" href="images/logo/favicon.ico" type="image/x-icon">
    <link href="js/font/material.css?v=1.0.0.54" rel="stylesheet" type="text/css">
    <link href="plugins/bootstrap/css/bootstrap.css?v=1.0.0.54" rel="stylesheet">
    <link href="css/game.css?v=1.0.0.54" rel="stylesheet">
    <link href="plugins/animate-css/animate.css?v=1.0.0.54" rel="stylesheet"/>
    <link href="plugins/sweetalert/sweetalert.css?v=1.0.0.54" rel="stylesheet"/>
    <link href="css/style.css?v=1.0.0.54" rel="stylesheet">
    <link href="css/themes/all-themes.css?v=1.0.0.54" rel="stylesheet"/>
    <style>
        .swal2-container {
            z-index: 999999999999;
        }
    </style>
    <script>
        LOADEDG = 0;

        function loadedg() {
            LOADEDG++;
        }
    </script>
    <style>
        .myicon {
            top: 0 !important;
            left: -5px;
        }

        .menuButton {
            margin-bottom: 4px;
            width: 100%;
            height: 50px;
        }

        .tab-pane {
            margin-left: 20px !important;
            width: 94% !important;
        }

        .DialogWindow {
            padding: 8px;
            background: radial-gradient(circle, rgba(2, 0, 36, 1) 74%, rgba(14, 9, 121, 1) 97%);
        }

        .pokemonLife {
            width: 40%;
            float: right;
            text-align: right;
            font-size: 18px;
            border: 2px #000 solid;
            background-color: whitesmoke;
            text-transform: capitalize;
            padding: 3px;
        }

        .friendLife {

        }

        .pokemonLife div {
            width: 100%;
            text-transform: capitalize;
            padding: 8px;
            transition: width 4s,;
            border: 1px solid #333;
            border-radius: 11px;
        }

        .friendLife {
            float: left;
            text-align: left;
        }

        #footer {
            background-color: transparent !important;
        }

        #footer2 {
            background-color: transparent !important;
            text-align: right;
        }

        #gameMenu {
            position: absolute;
            z-index: 999;
            width: 98%;
            height: 100%;
            background: rgb(2, 0, 36);
            background: radial-gradient(circle, rgba(2, 0, 36, 1) 74%, rgba(14, 9, 121, 1) 97%);
        }

    </style>
</head>


<body oncontextmenu="return false;"
      style="overflow: hidden;font-family:font-family: monospace;background-color: black">

<section id="play" ng-app="pokemon" ng-controller="play">

    <div class="page-loader-wrapper">
        <div class="loader">
            <div class="preloader">
                <div class="spinner-layer pl-red">
                    <div class="circle-clipper left">
                        <div class="circle"></div>
                    </div>
                    <div class="circle-clipper right">
                        <div class="circle"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="page-loader-wrapper2" id="globalload" style="display: none">
        <div class="loader">
            <div class="preloader">
                <div class="spinner-layer pl-red">
                    <div class="circle-clipper left">
                        <div class="circle"></div>
                    </div>
                    <div class="circle-clipper right">
                        <div class="circle"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="overlay"></div>

    <!--GAME-->
    <div id="main">
        <canvas style="{{PKM.perishsong?'filter: sepia(1);':''}}z-index: 1; position: absolute; margin: auto; top: 0px; left: 0px; right: 0px; bottom: 0px; width: {{bounds().width}}px; height: {{bounds().height}}px;"
                width="{{bounds().width}}"
                height="{{bounds().height}}"
                id="game">
        </canvas>
        <canvas style="user-select: auto;touch-action: none;pointer-events:none;z-index: 20; position: absolute; margin: auto; top: 0px; left: 0px; right: 0px; bottom: 0px; width: {{bounds().width}}px; height: {{bounds().height}}px;"
                width="{{bounds().width}}"
                height="{{bounds().height}}"
                id="animations">
        </canvas>
        <img ng-show="BATTLEOBJS.terrain"
             style="opacity: 0.7;user-select: auto;touch-action: none;pointer-events:none;z-index: 8; position: absolute; margin: auto; top: 0px; left: 0px; right: 0px; bottom: 0px; width: {{bounds().width}}px; height: {{bounds().height}}px;"
             width="{{bounds().width}}"
             height="{{bounds().height}}"
             ng-src="../resources/pseudoweather/{{BATTLEOBJS.terrain}}.png"
             id="terrain"/>
        <img ng-show="BATTLEOBJS.clima"
             style="user-select: auto;touch-action: none;pointer-events:none;z-index: 20; position: absolute; margin: auto; top: 0px; left: 0px; right: 0px; bottom: 0px; width: {{bounds().width}}px; height: {{bounds().height}}px;"
             width="{{bounds().width}}"
             height="{{bounds().height}}"
             ng-src="../resources/clima/{{BATTLEOBJS.clima}}.gif"
             id="clima"/>
        <div ng-show="PKM.evolutioning" class="proBG"
             style="text-transform: capitalize;user-select: auto;touch-action: none;pointer-events:none;z-index: 9999; position: absolute; margin: auto; top: 0px; left: 0px; right: 0px; bottom: 0px; width: 100%; height: {{bounds().height}}px;"
             width="{{bounds().width}}"
             height="{{bounds().height}}"
             id="evolution">
            <center>
                <img class=""
                     id="evolutionPokemon" style="right: 47%;bottom: 50%;position: absolute;"
                     ng-src="{{PKM.evolutioning}}">
                <span style="color: white;font-size: 24px">{{PKM.evoltext}}</span>
            </center>
        </div>
        <div ng-click="PKM.maper=false" ng-show="PKM.maper"
             style="user-select: auto;touch-action: none;pointer-events:none;z-index: 20; position: absolute; margin: auto; top: 0px; left: 0px; right: 0px; bottom: 0px; width: {{bounds().width}}px; height: {{bounds().height}}px;"
             width="{{bounds().width}}"
             height="{{bounds().height}}"
             id="maper">
            <center>
                <img ng-click="PKM.maper=false" style="width: {{bounds().width}}px; height: {{bounds().height}}px;"
                     ng-src="{{DOMAINRESOURCE}}resources/system/map{{LAN.CODE}}.png?av=1">
                <img style=" position: absolute;clip: rect(0, 48px, 33px, 0);{{mapperIcon}}"
                     src="{{DOMAIN}}data/players/{{session.name}}/images/tv.png">
            </center>
        </div>
    </div>
    <!--MENU-->
    <div id="footer" class="{{menuOpen?'bg-black':'bg-blue-grey'}}"
         style="float: left;z-index: 9999;width: {{menuOpen?'100%':'75px'}};padding: 5px">
        <button ng-if="menu && !menuOpen" type="button" onclick="ACTIONS.GAME.MENUTOGGLE()"
                class="btn bg-green waves-effect waves-circle waves-float menuButton">
            <i class="material-icons myicon">home</i>
        </button>

        <button ng-if="menu && !menuOpen" type="button" ng-click="PKM.maper=!PKM.maper"
                class="btn bg-blue waves-effect waves-circle waves-float menuButton">
            <i class="material-icons myicon">map</i>
        </button>

        <button ng-if="menu && !menuOpen && logro.script && logro.icon && $index%2===0"
                ng-repeat="(mkey,logro) in  skills"
                class="btn bg-blue-grey waves-effect waves-circle waves-float menuButton">
            <img ng-click="runQuickLogro(logro)"
                 class="menuButton"
                 style="margin: 0;width: 32px;height: 32px;background-image: url('../resources/system/IconSet.png');background-position: -{{icon(logro.icon).x}}px -{{icon(logro.icon).y}}px;">
        </button>
    </div>
    <div id="gameMenu" ng-show="menuOpen">
        <div style="text-align: center">
            <button type="button" onclick="ACTIONS.GAME.MENUTOGGLE()"
                    class="btn btn-danger btn-circle-lg waves-effect waves-circle waves-float">
                <i class="material-icons">cancel</i>

            </button>
            <button ng-show="!menuMessage" type="button" ng-click="subMenu(homemenu.name)"
                    ng-repeat="(key, homemenu) in interface"
                    style="margin: 10px 10px 10px 10px;    font-size: 24px;color: #fff0ff !important;"
                    class="btn bg-{{subMenuOpen===homemenu.name?homemenu.color+' ':'blue-grey btn-circle-lg'}}   waves-effect waves-circle waves-float">
                <i class="material-icons">{{homemenu.icon}}</i>
                <label style="text-transform: capitalize"
                       ng-show="subMenuOpen===homemenu.name">{{homemenu.text}}</label>
            </button>
        </div>

        <div ng-if="menuMessage"
             style="color: white;overflow: scroll;width: 97%;min-height: 270px;z-index: 30;"
             class="bg-blue-grey tab-pane fade animated bounceInLeft in active">
            <div style="margin: 15px">
                <h3>{{menuMessage.term}}</h3>
                <h4>{{menuMessage.name}}:</h4>
                <p style="font-size: 18px">{{menuMessage.desc}}</p>
                <button onclick="ACTIONS.GAME.MENUMESSAGE_CLOSE()" type="button" class="btn btn-danger waves-effect">
                    <i class="material-icons">keyboard_backspace</i>
                </button>
            </div>
        </div>

        <div ng-if="!menuMessage &&  subMenuOpen==='perfil'"
             style="color: white;overflow: scroll"
             class="tab-pane fade animated bounceInRight in active">
            <table style="width: 97%;font-size: 18px" class="">
                <tr>
                    <td class="bg-blue text-center" style="border: #fff0ff 1px solid;text-transform: capitalize">
                        {{::session.name}}
                    </td>
                    <td class="bg-blue" colspan="9" style="text-align: center;border: #fff0ff 1px solid">
                        {{::LAN.t("Medals")}} - {{::LAN.t("Rating")}}: {{session.rating||0}}
                    </td>
                </tr>
                <tr>
                    <td class="bg-blue-grey" rowspan="3"
                        style="text-align: center !important;border: #fff0ff 1px solid">
                        <img ng-src="{{DOMAIN}}data/players/{{session.id}}/images/face.png?{{hero.version}}">
                        <br>
                    </td>
                </tr>
                <tr class="bg-blue-grey" style="border: #fff0ff 1px solid">
                    <td ng-repeat="(key,medal) in medals1" style="text-align: center">
                        <img ng-if="!session['medal_'+medal.type]" width="48" height="48" style="opacity: 0.3;"
                             ng-src="{{DOMAINRESOURCE}}resources/poekemon/medals/{{medal.name}}_shadow.png">
                        <img ng-if="session['medal_'+medal.type]" width="48" height="48"
                             ng-src="{{DOMAINRESOURCE}}resources/poekemon/medals/{{medal.name}}_{{session['medal_'+medal.type]}}.png">
                        <br>
                    </td>
                </tr>
                <tr class="bg-blue-grey" style="border: #fff0ff 1px solid">
                    <td ng-repeat="(key,medal) in medals2" style="text-align: center">
                        <img ng-if="!session['medal_'+medal.type]" width="48" height="48" style="opacity: 0.3;"
                             ng-src="{{DOMAINRESOURCE}}resources/poekemon/medals/{{medal.name}}_shadow.png">
                        <img ng-if="session['medal_'+medal.type]" width="48" height="48"
                             ng-src="{{DOMAINRESOURCE}}resources/poekemon/medals/{{medal.name}}_{{session['medal_'+medal.type]}}.png">
                        <br>
                    </td>
                </tr>
                <tr>
                    <td colspan="10" style="text-align: right">
                        {{::LAN.t("Time")}}: {{LAN.t(TimeText)}}
                    </td>
                </tr>

            </table>

            <button type="button" onclick="signOut();"
                    style="margin: 10px 10px 10px 10px;font-size: 24px;"
                    class="btn bg-pink  btn-lg waves-effect waves-circle waves-float">
                <i class="material-icons">reply</i>
                {{::LAN.t("Logout")}}
            </button>

            <button type="button" onclick="location.href='face.html'"
                    style="margin: 10px 10px 10px 10px;font-size: 24px;"
                    class="btn bg-pink  btn-lg waves-effect waves-circle waves-float">
                <i class="material-icons">face</i>
                {{::LAN.t("Appearance")}}
            </button>

            <button ng-if="LAN.CODE==='_es'" style="margin: 10px 10px 10px 10px;font-size: 24px;"
                    onclick="ACTIONS.GAME.CHANGELANGUAGE('')"
                    type="button"
                    class="btn bg-green btn-lg m-l-15 waves-effect animated bounceInLeft in">
                English
            </button>
            <button ng-if="LAN.CODE!=='_es'" style="margin: 10px 10px 10px 10px;font-size: 24px;"
                    onclick="ACTIONS.GAME.CHANGELANGUAGE('es')"
                    type="button"
                    class="btn bg-amber btn-lg m-l-15 waves-effect animated bounceInLeft in">
                Español
            </button>

            <script>
                function signOut() {
                    swal({
                        title: LANGUAGE.t(`Are you sure you want to close this session?`),
                        showCancelButton: true,
                        confirmButtonColor: "#DD6B55",
                        confirmButtonText: LANGUAGE.t("Yes"),
                        cancelButtonText: LANGUAGE.t("No"),
                        closeOnConfirm: false,
                        showLoaderOnConfirm: false,
                    }, function () {
                        var returnIdioma = "";
                        if (STORAGED.lan())
                            returnIdioma = STORAGED.lan();
                        STORAGED.delete();

                        if (returnIdioma)
                            location.href = "index.html?lan=" + returnIdioma;
                        else
                            location.href = "index.html";
                    });
                }
            </script>
        </div>

        <div ng-if="!menuMessage &&  subMenuOpen==='pokemons'"
             style="color: white;overflow: scroll;width: 97%;min-height: 270px;"
             class="bg-light-green tab-pane fade animated bounceInRight in active">
            <div>
                <div style="width: 100%;float: left;    min-height: 275px;">
                    <table class="table-bordered {{selectedPokemonClick().shiny? 'bg-lime':''}}"
                           ng-if="selectedPokemonClick()" style="width: 100%">
                        <tbody>
                        <tr>
                            <td style="text-align: center" rowspan="2">
                                <img style=" transform: scale(1);{{selectedPokemonClick().style}}"
                                     ng-src="{{selectedPokemonClick().imageUrl}}">
                            </td>
                            <td colspan="2" style="text-transform: capitalize;text-align: left">
                                <div style="list-style: none;text-align: left">

                                    <btn
                                            style="float: left;min-width: 50%;text-align: left"
                                            class="btn btn-default">
                                        {{selectedPokemonClick().name}}

                                        <img style="margin-left: 5px;text-align: left"
                                             ng-repeat="(tkey, type) in selectedPokemonClick().types"
                                             ng-src="{{DOMAINRESOURCE}}resources/poekemon/types/{{type}}.png">
                                        <img ng-src="../resources/icons/{{selectedPokemonClick().gender}}.png">
                                    </btn>

                                    <btn
                                            ng-click="desc(LAN.t('Ability'),LAN.t(selectedPokemonClick().ability.name),LAN.t(selectedPokemonClick().ability.shortDesc))"
                                            style="float: left;min-width: 50%;text-align: left"
                                            class="btn btn-default">
                                        {{LAN.t(selectedPokemonClick().ability.name)}}
                                        ({{selectedPokemonClick().ability.rating}})
                                        <img style="visibility: hidden"
                                             ng-src="../resources/icons/{{selectedPokemonClick().gender}}.png">
                                    </btn>
                                    <div class="pokemonLife friendLife" style="width: 100%;border-width: 3px">
                                        <div class="{{PKM.hpcolor(PKM.hp(selectedPokemonClick()))}}"
                                             style="width: {{PKM.hp(selectedPokemonClick())}}%">

                                        </div>
                                    </div>

                                </div>
                            </td>
                            <td>
                                <button ng-show="session.pokemons.length>1"
                                        ng-click="deletePokemon(selectedPokemonClick(),selectedPokemon)" type="button"
                                        class="btn bg-red waves-effect">
                                    <i class="material-icons">delete</i>
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <div>
                                    <btn
                                            ng-repeat="(mkey,move) in  selectedPokemonClick().moves"
                                            ng-click="desc(LAN.t('Move'),LAN.t(move.name),LAN.t(move.shortDesc))"
                                            style="float: left;min-width: 50%;background-color: {{typeColor[move.type]}};text-align: left"
                                            class="btn ">
                                        <img ng-src="{{DOMAINRESOURCE}}resources/poekemon/types/{{move.type}}.png"
                                             style="margin-left: 5px">
                                        <b> {{LAN.t(move.name)}}</b>
                                        <img ng-src="{{DOMAINRESOURCE}}resources/poekemon/category/{{move.category}}.png"
                                             style="margin-left: 5px">

                                    </btn>

                                </div>
                            </td>
                            <td>
                                <button ng-show="session.pokemons.length>1"
                                        ng-click="trasladePokemon(selectedPokemonClick(),selectedPokemon)" type="button"
                                        class="btn bg-blue waves-effect">
                                    <i class="material-icons">desktop_windows</i>
                                </button>
                            </td>
                        </tr>
                        <tr ng-show="session.pokemons.length>1">
                            <td colspan="4">
                                <div class="table-bordered">
                                    <div class=".sorting"
                                         style="text-transform: capitalize;text-align: center !important;width: 16%;display: inline-block"
                                         ng-repeat="(kpo,pokemon) in session.pokemons">
                                        <button ng-show="session.pokemons.length>1" ng-click="itemOnLongPress($index)"
                                                type="button"
                                                class="btn bg-teal waves-effect"
                                                style="height: 22px;padding: 0;width: 36px;">
                                            <i class="material-icons">keyboard_backspace</i>
                                        </button>
                                    </div>
                                    <br>
                                    <div class=".sorting"
                                         style="text-transform: capitalize;text-align: center !important;width: 16%;display: inline-block"
                                         ng-repeat="(kpo,pokemon) in session.pokemons">
                                        <img
                                                ng-click="menuPokemon($index)"
                                                style="transform: scale(0.5);{{pokemon.style}};{{PKM.hp(pokemon)<=0?'filter: grayscale(1);':''}}"
                                                ng-src="{{pokemon.imageUrl}}">
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>

                </div>
            </div>
        </div>

        <div ng-if="!menuMessage &&  subMenuOpen==='bobeda'"
             style="color: white;overflow: scroll;width: 97%;min-height: 270px;"
             class="bg-teal tab-pane fade animated bounceInRight in active">
            <div>
                <div class="table-bordered" style="width: 20%;float: left;min-height: 275px;">
                    <div
                            style="text-transform: capitalize;text-align: center !important;width: 50%;display: inline-block"
                            ng-repeat="(kpo,pokemon) in session.bobeda">
                        <img ng-click="menuBobeda($index)" style=" transform: scale(0.7);{{pokemon.style}}"
                             ng-src="{{pokemon.imageUrl}}">
                    </div>
                </div>
                <div style="width: 80%;float: left;    min-height: 275px;">
                    <table class="table-bordered {{selectedBobedaClick().shiny? 'bg-lime':''}}"
                           ng-if="selectedBobedaClick()" style="width: 100%">
                        <tbody>
                        <tr>
                            <td rowspan="2" style="text-align: center">
                                <img style=" transform: scale(1);{{selectedBobedaClick().style}}"
                                     ng-src="{{selectedBobedaClick().imageUrl}}">
                            </td>
                        </tr>
                        <tr>
                            <td style="text-transform: capitalize;text-align: left">
                                <div style="list-style: none;text-align: left">

                                    <btn
                                            style="float: left;min-width: 50%;text-align: left"
                                            class="btn btn-default">
                                        {{selectedBobedaClick().name}}

                                        <img style="margin-left: 5px;text-align: left"
                                             ng-repeat="(tkey, type) in selectedBobedaClick().types"
                                             ng-src="{{DOMAINRESOURCE}}resources/poekemon/types/{{type}}.png">
                                        <img ng-src="../resources/icons/{{selectedBobedaClick().gender}}.png">
                                    </btn>

                                    <btn
                                            ng-click="desc(LAN.t('Ability'),LAN.t(selectedBobedaClick().ability.name),LAN.t(selectedBobedaClick().ability.shortDesc))"
                                            style="float: left;min-width: 50%;text-align: left"
                                            class="btn btn-default">
                                        {{LAN.t(selectedBobedaClick().ability.name)}}
                                        ({{selectedBobedaClick().ability.rating}})
                                        <img style="visibility: hidden"
                                             ng-src="../resources/icons/{{selectedBobedaClick().gender}}.png">
                                    </btn>

                                </div>
                            </td>
                            <td>
                                <button ng-click="deleteBobeda(selectedBobedaClick(),selectedBobeda)" type="button"
                                        class="btn bg-red waves-effect">
                                    <i class="material-icons">delete</i>
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <div>
                                    <btn
                                            ng-repeat="(mkey,move) in  selectedBobedaClick().moves"
                                            ng-click="desc(LAN.t('Move'),LAN.t(move.name),LAN.t(move.shortDesc))"
                                            style="float: left;min-width: 50%;background-color: {{typeColor[move.type]}};text-align: left"
                                            class="btn ">
                                        <img ng-src="{{DOMAINRESOURCE}}resources/poekemon/types/{{move.type}}.png"
                                             style="margin-left: 5px"> <b> {{LAN.t(move.name)}}</b>
                                        <img ng-src="{{DOMAINRESOURCE}}resources/poekemon/category/{{move.category}}.png"
                                             style="margin-left: 5px">
                                    </btn>
                                </div>
                            </td>
                            <td>
                                <button ng-click="includePokemon(selectedBobedaClick(),selectedBobeda)" type="button"
                                        class="btn bg-blue waves-effect">
                                    <i class="material-icons">keyboard_return</i>
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>

                </div>
            </div>
        </div>

        <div ng-if="!menuMessage &&  subMenuOpen==='logros'"
             style="color: white;overflow: scroll;width: 97%;min-height: 270px;padding: 15px;"
             class="bg-orange tab-pane fade animated bounceInRight in active">
            <div ng-repeat="(mkey,logro) in  skills">
                <btn
                        ng-click="desc(logro.term,logro.name,logro.desc)"
                        style="float: left;font-size: large;text-align: center;padding: 17px;margin: 10px;min-width: 65px"
                        class="btn {{logro.script?'bg-blue-grey':'bg-yellow'}} ">
                    <img style="width: 32px;height: 32px;background-image: url('../resources/system/IconSet.png');background-position: -{{icon(logro.icon).x}}px -{{icon(logro.icon).y}}px;"
                         ng-if="logro.icon">
                </btn>

            </div>
        </div>


        <div ng-if="!menuMessage &&  subMenuOpen==='friends'"
             style="color: white;overflow: scroll;width: 97%;min-height: 270px;"
             class="bg-pink tab-pane fade animated bounceInRight in active">
            <div class="row">
                <div class="col-xs-12" style="margin-left: 7px;">
                    <button type="button" style="float: left;font-size: 18px;width: 33.33%;"
                            ng-click="toggleAddingFriend=!toggleAddingFriend;"
                            class="btn bg-light-green btn-lg waves-effect waves-circle waves-float">
                        <i class="material-icons">person_add</i>
                        <d ng-show="!toggleAddingFriend">{{::LAN.t("Add Friend")}}</d>
                        <d ng-show="toggleAddingFriend">{{::LAN.t("Close")}}</d>
                    </button>
                    <div style="float: left;width: 66%;padding: 10px;" ng-show="toggleAddingFriend"
                         class="animated fadeIn in">
                        <label style="font-size: 18px">{{::LAN.t("Friend Name")}}</label>
                        <input style="width: 100%" id="toggleAddingFriend" ng-model="PKM.addingFriend"
                               class="btn form-control">
                        <button ng-click="PKM.AddFriend(PKM.addingFriend)" style="width: 100%;font-size: 24px;"
                                class="btn bg-light-green">
                            {{toggleText||LAN.t("Add")}}
                        </button>
                    </div>
                    <button type="button" style="float: left;font-size: 18px;"
                            ng-click="PKM.RatedFight()"
                            class="btn bg-green btn-lg waves-effect waves-circle waves-float">
                        <i class="material-icons">zoom_in</i>
                        {{::LAN.t("Rated Battle")}} 
                        <br ng-show="PKM.ratedBattleText">   
                        <label style="font-size: 18px" ng-show="PKM.ratedBattleText">{{::LAN.t("Loading")}}</label>
                    </button>
                    <button type="button" style="float: left;font-size: 18px;width: 33.34%;"
                            ng-click="PKM.MirrorBattle()"
                            class="btn bg-blue-grey btn-lg waves-effect waves-circle waves-float">
                        <i class="material-icons">security</i>
                        {{::LAN.t("Mirror Battle")}}
                    </button>
                </div>
                <div class="col-xs-12" style="overflow: scroll;padding: 10px;font-size: 18px;margin-left: 12px">
                    <div>
                        <div ng-repeat="(key,friend) in session.friends"
                             style="float: left;text-align: center;padding: 5px;"
                             class="bg-white">
                            <button ng-click="PKM.DeleteFriend(friend)" style="width: 100%" class="btn bg-red">
                                {{LAN.t("Delete")}}
                            </button>
                            <br>
                            <img style="width: 72px" ng-src="{{DOMAIN}}data/players/{{friend}}/images/face.png">
                            <br>
                            <button ng-click="PKM.FightFriend(friend)" style="text-transform: capitalize"
                                    class="btn bg-green">{{friend}} -
                                {{LAN.t("Fight")}}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="footer2" class="{{menuOpen?'bg-black':'bg-blue-grey'}}"
         style="float: right;z-index: 9999;width: {{menuOpen?'100%':'75px'}};padding: 5px">

        <button ng-if="muted && !menuOpen" type="button" onclick="ACTIONS.GAME.MUTE_OFF()"
                class="btn bg-red waves-effect waves-circle waves-float menuButton">
            <i class="material-icons myicon">volume_off</i>
        </button>

        <button ng-if="!muted && !menuOpen" type="button" onclick="ACTIONS.GAME.MUTE()"
                class="btn btn-red waves-effect waves-circle waves-float menuButton">
            <i class="material-icons myicon">volume_up</i>
        </button>

        <button ng-if="menu && !menuOpen && logro.script && logro.icon && $index%2!==0"
                ng-repeat="(mkey,logro) in  skills"

                class="btn bg-blue-grey waves-effect waves-circle waves-float menuButton">
            <img ng-click="runQuickLogro(logro)"
                 class="menuButton"
                 style="margin: 0;width: 32px;height: 32px;background-image: url('../resources/system/IconSet.png');background-position: -{{icon(logro.icon).x}}px -{{icon(logro.icon).y}}px;">
        </button>


    </div>
    <div ng-if="isBattlening && !PKM.forcehidemenu" style="position: absolute;z-index: 9999;width: 98%;padding: 3px">
        <div id="lifes">
            <div class="pokemonLife friendLife" ng-click="menuPokemon(BATTLEOBJS.FRIENDINDEX, true)">
                {{PKM.friend().name}} <img ng-src="../resources/icons/{{PKM.friend().gender}}.png">
                <div class="{{PKM.hpcolor(PKM.hp(PKM.friend()))}}"
                     style="width: {{PKM.hp(PKM.friend())}}%;transition: width 2s, height 4s;">
                </div>
                <label class="StatusText" style="background-color: {{typeColor[PKM.friend().battle.statusType]}}"
                       ng-show="PKM.friend().battle.status">
                    {{PKM.friend().battle.status}} x{{PKM.friend().battle.statusTurn}}
                </label>
                <label class="STATSText bg-red" ng-show="PKM.friend().battle.stats.atk!==0">
                    a{{PKM.friend().battle.stats.atk*-1}}
                </label>
                <label class="STATSText bg-blue" ng-show="PKM.friend().battle.stats.def!==0">
                    d{{PKM.friend().battle.stats.def*-1}}
                </label>
                <label class="STATSText bg-amber" ng-show="PKM.friend().battle.stats.spe!==0">
                    s{{PKM.friend().battle.stats.spe*-1}}
                </label>
                <label class="STATSText bg-pink" ng-show="PKM.friend().battle.stats.spa!==0">
                    sa{{PKM.friend().battle.stats.spa*-1}}
                </label>
                <label class="STATSText bg-cyan" ng-show="PKM.friend().battle.stats.spd!==0">
                    sd{{PKM.friend().battle.stats.spd*-1}}
                </label>
                <label class="STATSText bg-brown" ng-show="PKM.friend().battle.stats.accuracy!==0">
                    ac{{PKM.friend().battle.stats.accuracy*-1}}
                </label>
                <label class="STATSText bg-blue-grey" ng-show="PKM.friend().battle.stats.evasion!==0">
                    ev{{PKM.friend().battle.stats.evasion*-1}}
                </label>
                <div ng-repeat="(kpo,pokemon) in session.pokemons"
                     style="margin-top: 5px;float: right;width: 10px;height: 10px;border-radius: 100%;border: 1px black solid;"
                     class="{{PKM.hpcolor(PKM.hp(pokemon))}}">
                </div>
            </div>
            <div class="pokemonLife" ng-show="PKM.target().battle" onclick="ACTIONS.UNIT.NEXT();">
                <img ng-src="../resources/icons/{{PKM.target().gender}}.png"> {{PKM.target().name}}
                <div class="{{PKM.hpcolor(PKM.hp(PKM.target()))}}"
                     style="width: {{PKM.hp(PKM.target())}}%;transition: width 2s, height 4s;">
                </div>
                <label class="StatusText"
                       style="float: left; background-color: {{typeColor[PKM.target().battle.statusType]}}"
                       ng-show="PKM.target().battle.status">
                    {{PKM.target().battle.status}} x{{PKM.target().battle.statusTurn}}
                </label>
                <label class="STATSText bg-red" ng-show="PKM.target().battle.stats.atk!==0" style="float: left;">
                    a{{PKM.target().battle.stats.atk*-1}}
                </label>
                <label class="STATSText bg-blue" ng-show="PKM.target().battle.stats.def!==0" style="float: left;">
                    d{{PKM.target().battle.stats.def*-1}}
                </label>
                <label class="STATSText bg-amber" ng-show="PKM.target().battle.stats.spe!==0" style="float: left;">
                    s{{PKM.target().battle.stats.spe*-1}}
                </label>
                <label class="STATSText bg-pink" ng-show="PKM.target().battle.stats.spa!==0" style="float: left;">
                    sa{{PKM.target().battle.stats.spa*-1}}
                </label>
                <label class="STATSText bg-cyan" ng-show="PKM.target().battle.stats.spd!==0" style="float: left;">
                    sd{{PKM.target().battle.stats.spd*-1}}
                </label>
                <label class="STATSText bg-brown" ng-show="PKM.target().battle.stats.accuracy!==0" style="float: left;">
                    ac{{PKM.target().battle.stats.accuracy*-1}}
                </label>
                <label class="STATSText bg-blue-grey" ng-show="PKM.target().battle.stats.evasion!==0"
                       style="float: left;">
                    ev{{PKM.target().battle.stats.evasion*-1}}
                </label>
                <div ng-repeat="(kpo,pokemon) in BATTLEOBJS.TARGETS"
                     style="margin-top: 5px;float: right;width: 10px;height: 10px;border-radius: 100%;border: 1px black solid;"
                     class="{{PKM.hpcolor(PKM.hp(pokemon))}}">
                </div>
            </div>
        </div>

        <button style="width: 20%;margin-top: 2px" ng-if="muted && !menuOpen" type="button"
                onclick="ACTIONS.GAME.MUTE_OFF()"
                class="btn bg-red waves-effect waves-circle waves-float menuButton">
            <i class="material-icons myicon">volume_off</i>
        </button>

        <button style="width: 20%;margin-top: 2px" ng-if="!muted && !menuOpen" type="button"
                onclick="ACTIONS.GAME.MUTE()"
                class="btn btn-red waves-effect waves-circle waves-float menuButton">
            <i class="material-icons myicon">volume_up</i>
        </button>

        <button ng-if="PKM.mainMenu && (PKM.friend().battle.status!=='partiallytrapped' && PKM.target().battle.status !== 'ingrain') && session.pokemons.length>1"
                style="width: 20%;    font-size: 18px;" type="button" ng-click="PKM.menu_open();"
                class="btn bg-orange">
            {{LAN.t("Change")}}<i class="material-icons">swap_vertical_circle</i>
        </button>


    </div>
    <div ng-if="PKM.mainMenu" style="position: absolute;z-index: 9999;width: 98%;padding: 3px">
        <div ng-if="menuMessage"
             style="color: white;overflow: scroll;width: 97%;min-height: 270px;z-index: 30;"
             class="bg-blue-grey tab-pane fade animated bounceInLeft in active">
            <div style="margin: 15px">
                <h3>{{menuMessage.term}}</h3>
                <h4>{{menuMessage.name}}:</h4>
                <p style="font-size: 18px">{{menuMessage.desc}}</p>
                <button onclick="ACTIONS.GAME.MENUMESSAGE_CLOSE()" type="button" class="btn btn-danger waves-effect">
                    <i class="material-icons">keyboard_backspace</i>
                </button>
            </div>
        </div>

        <!--        Menu pokemon dentro de la batalla-->
        <div id="pokmonDetail" ng-if="PKM.pokemonDetail" class="bg-white proBG pokmonDetail" style="padding: 10px">
            <table class="{{selectedPokemonClick().shiny? 'bg-lime':''}}"
                   ng-if="selectedPokemonClick()" style="width: 100%">
                <tbody>
                <tr>
                    <td style="text-align: center;width: 75%">
                    </td>
                    <td rowspan="3" style="    text-align: center;width: 25%">

                        <img style=" transform: scale(1);{{selectedPokemonClick().style}}"
                             ng-src="{{selectedPokemonClick().imageUrl}}">
                    </td>
                </tr>
                <tr>
                    <td style="text-transform: capitalize;text-align: left">
                        <div style="list-style: none;text-align: left;padding: 5px;font-size: 16px;"
                             class="bg-blue-grey">
                            <b>{{LAN.t(selectedPokemonClick().ability.name)}}
                                ({{selectedPokemonClick().ability.rating}})</b>:
                            {{LAN.t(selectedPokemonClick().ability.shortDesc)}}
                        </div>

                    </td>
                    <td>

                    </td>
                </tr>
                <tr>
                    <td>
                        <div>
                            <btn ng-repeat="(mkey,move) in  PKM.moves(selectedPokemonClick())"
                                 style="    margin-top: 5px;float: left;min-width: 100%;background-color: {{typeColor[move.type]}};text-align: left;font-size: 16px"
                                 class="btn ">
                                <img ng-src="{{DOMAINRESOURCE}}resources/poekemon/types/{{move.type}}.png"
                                     style="margin-left: 5px">
                                <b> {{LAN.t(move.name)}}</b>
                                <img ng-src="{{DOMAINRESOURCE}}resources/poekemon/category/{{move.category}}.png"
                                     style="margin-left: 5px">: {{LAN.t(move.shortDesc)}}
                            </btn>
                            <btn style="text-align: left" class="btn btn-default">
                                <b style="text-transform: capitalize"> {{selectedPokemonClick().name}} </b>
                                <img style="margin-left: 5px;text-align: left"
                                     ng-repeat="(tkey, type) in selectedPokemonClick().types"
                                     ng-src="{{DOMAINRESOURCE}}resources/poekemon/types/{{type}}.png">
                                <img ng-src="../resources/icons/{{selectedPokemonClick().gender}}.png">
                            </btn>
                        </div>
                    </td>
                    <td>

                    </td>
                </tr>
                </tbody>
            </table>
            <center>
                <button ng-click=" PKM.previewClose()" type="button"
                        style="width: 70%;height: 50px;font-size: 26px;    margin: 10px;"
                        class="btn btn-danger waves-effect">
                    <i class="material-icons">keyboard_backspace</i> {{LAN.t("Back")}}
                </button>
            </center>
        </div>

        <div ng-if="PKM.menu || PKM.hp(PKM.friend())<=0 || BATTLEOBJS.batonpass"
             style="color: white;overflow: scroll;width: 97%;padding: 15px;height: 100%"
             class=" bg-white proBG tab-pane fade animated bounceInRight in active pokmonDetail">

            <table style="text-align: center;width: 100%;    margin-top: 50px;"
                   ng-show="PKM.friend().battle.canChange!==false || PKM.hp(PKM.friend())<=0">
                <tr>

                    <td style="width: 20%;float: left;position: relative;height: 100px"
                        ng-repeat="(kpo,pokemon) in session.pokemons"
                        ng-show="(BATTLEOBJS.FRIENDINDEX+'')!==($index+'')">

                        <img style="position: absolute;right: 0;bottom: 0;display: inline-block;{{pokemon.style}};{{PKM.hp(pokemon)<=0?'filter: grayscale(1);':''}}"
                             ng-click="menuPokemon($index,true)" ng-src="{{pokemon.imageUrl}}">
                    </td>
                </tr>
                <tr>
                    <td style="width: 20%;float: left;" ng-repeat="(kpo,pokemon) in session.pokemons"
                        ng-show="(BATTLEOBJS.FRIENDINDEX+'')!==($index+'')">
                        <div style="width: 100%">
                            <div class="{{PKM.hpcolor(PKM.hp(pokemon))}}"
                                 style="width: {{PKM.hp(pokemon)}}%;    height: 20px;    margin: 4px;    border-radius: 20px;    border: 1px black solid;">
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="width: 20%;float: left;" ng-repeat="(kpo,pokemon) in session.pokemons"
                        ng-show="(BATTLEOBJS.FRIENDINDEX+'')!==($index+'')">
                        <button ng-show="PKM.hp(pokemon)>0" style="font-size: 18px" type="button"
                                ng-click="PKM.changefriend($index)"
                                class="btn bg-red waves-effect">
                            <i class="material-icons">cached</i>{{LAN.t("Change")}}
                        </button>

                        <button ng-show="!PKM.hp(pokemon)>0" type="button"
                                class="btn bg-grey waves-effect">
                            <i class="material-icons">cached</i>
                        </button>
                    </td>
                </tr>
            </table>
            <div style="width: 100%; text-align: center;margin-top: 50px">
                <button ng-click="PKM.menu_close()" ng-show="PKM.hp(PKM.friend())>0 && !BATTLEOBJS.batonpass"
                        type="button"
                        class="btn btn-danger waves-effect" style="width: 50%;font-size: 24px">
                    {{LAN.t("BackToFight")}}<i class="material-icons">keyboard_backspace</i>
                </button>

            </div>
        </div>


    </div>
    <div ng-if="PKM.mainMenu && !BATTLEOBJS.batonpass && !PKM.forcehidemenu"
         style="position: absolute;bottom: 2px;text-align: center;z-index: 999;opacity: 0.9;width: 98%">

        <btn ng-show="(PKM.pokeballCount && (BATTLEOBJS.isWild && (PKM.hp(PKM.friend())>0 && PKM.catchMove.num!==(BATTLEOBJS.disableMove||1).num))) && BATTLEOBJS.allowtrap"
             ng-click="PKM.attack(PKM.catchMove)"
             style="font-size: 26px;background-color: white;position: absolute;bottom: 68px;"
             class="btn ">
            <b> {{PKM.catchMove.name}}</b>

            <img style="background-position: -{{PKM.pokeballLevel*40.962}}px 0px;width: 40.962px;height: 40px;background-image: url('../resources/animations/Pokemon/pokeballs.png') ">({{PKM.pokeballCount}})
        </btn>
        <button ng-show="BATTLEOBJS.isWild && (PKM.friend().battle.status!=='partiallytrapped' && PKM.target().battle.status !== 'ingrain')"
                style="font-size: 26px;background-color: white;position: absolute;bottom: 68px;right: 0;"
                type="button"
                onclick="ACTIONS.POKEMON.BATTLEEND();"
                class="btn bg-red">
            {{LAN.t("Left")}} <i class="material-icons">directions_run</i>
        </button>
        <br>
        <btn ng-show="PKM.hp(PKM.friend())>0 && move.num!==(BATTLEOBJS.disableMove||1).num"
             ng-repeat="(mkey,move) in  PKM.friend().battle.moves || PKM.friend().moves"
             ng-click="PKM.attack(move)"

             style="padding: 0 !important;font-size: 24px;float: left;width: 50%;background-color: {{typeColor[move.type]}};text-align: left;{{PKM.gigamaxAttack(move)}}"
             class="btn ">
            <img ng-src="{{DOMAINRESOURCE}}resources/poekemon/types/{{move.type}}.png" style="margin-left: 5px"><b>
            {{LAN.t(move.name)}}</b>
            <img ng-src="{{DOMAINRESOURCE}}resources/poekemon/category/{{move.category}}.png" style="margin-left: 5px">
        </btn>

    </div>
    <div class="bg-white"
         style="color: black;padding: 0;text-align: left;z-index: 999999;display: none;position: absolute;float: right;border: red 1px solid;border-radius: 12px;bottom: 0;right: 0;"
         id="enemyText">
        <div id="enemyTextDiv" class="text-primary" style="float: left;"></div>
        <img style="float: right;width: 72px;" ng-show="!BATTLEOBJS.ENEMY.online"
             ng-src="{{DOMAIN}}data/characters_file/{{BATTLEOBJS.ENEMY.name}}/face.png?v=1.0.0.54">
        <img style="float: right;width: 72px;" ng-show="BATTLEOBJS.ENEMY.online"
             ng-src="{{DOMAIN}}data/players/{{BATTLEOBJS.ENEMY.name}}/images/face.png?v=1.0.0.54">
    </div>
    <!--MENU-->

    <!--TEXTS-->
    <div style="position: absolute;display: none;width: 98%;z-index: 99999" id="texts">
        <div class="DialogWindow" style="min-height: 172px;min-width: 600px;opacity: 1">
            <div class="DialogTitle">
                <img style="float: right"
                     ng-src="{{DOMAIN}}data/characters_file/{{dialogHero.name}}/face.png?v={{dialogHero.version||''}}">
                <label style="font-size: 24px;color: #673AB7">{{dialogHero.name}}:</label>
                <span style="font-size: 18px;" id="dialogTextD">
                    {{dialogText}}
                </span>
                <div style="margin-top: 45px">
                    <button style="margin-right: 10px;font-size: 20px" ng-click="value.click();"
                            onclick="$('#texts').hide();"
                            class="btn bg-{{_colors[$index]}} btn-large"
                            ng-repeat="(key,value) in dialogButtons">
                        <img ng-show="value.image" ng-src="{{value.image}}">
                        <img style="width: 32px;height: 32px;background-image: url('../resources/system/IconSet.png');background-position: -{{icon(value.icon).x}}px -{{icon(value.icon).y}}px;"
                             ng-show="value.icon"> {{value.text}}
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div style="position: absolute;    display: none;    width: 98%;    z-index: 99999;" id="notify"
         onclick="$('#notify').hide()">
        <div class="DialogWindow" style="min-width: 300px;width: 100%;font-size: 24px;" onclick="$('#notify').hide()">
            <div class="DialogTitle" style="text-align: center;margin-bottom: 0px" onclick="$('#notify').hide()">
                <span style="font-size: 18px;" onclick="$('#notify').hide()">
                    {{notificationText}}
                </span>
            </div>
        </div>
    </div>
    <div class="speech-bubble" style="position: absolute;display: none;z-index: 15" id="bubble">
        {{bubbleText}}
    </div>
    <!--TEXTS-->
    <div id="numpads" ng-show="!isBattlening && !menuOpen && menu"
         style="position: absolute;bottom: 10px;right: 10px;text-align: center;z-index: 999;opacity: 0.6;">
        <button id="arrow_upward" type="button" class="btn btn-lg bg-green" style="margin-bottom: 6px;">
            <i class="material-icons">arrow_upward</i>
        </button>
        <br>
        <button id="arrow_back" type="button" class="btn btn-lg bg-red">
            <i class="material-icons">arrow_back</i>
        </button>
        <button id="arrow_downward" type="button" class="btn btn-lg bg-blue">
            <i class="material-icons">arrow_downward</i>
        </button>
        <button id="arrow_forward" type="button" class="btn btn-lg bg-amber">
            <i class="material-icons">arrow_forward</i>
        </button>
    </div>


</section>

<script src="js/tools/codemirror.js"></script>
<script src="js/tools/javascript.js"></script>
<script src="js/tools/angular.min.js"></script>
<script src="js/tools/ui-codemirror.js"></script>
<script src="js/tools/autorefresh.js"></script>
<script src="plugins/jquery/jquery.min.js?v=1.0.0.54"></script>
<script src="plugins/bootstrap/js/bootstrap.js?v=1.0.0.54"></script>
<script src="js/tools/createjs.min.js?v=1.0.0.54"></script>
<script src="js/tools/tweenjsB.min.js?v=1.0.0.54"></script>
<script src="js/tools/ThresholdFilter.js?v=1.0.0.54"></script>
<script src="js/tools/tinycolor-min.js?v=1.0.0.54"></script>
<script src="js/tools/ScaleBitmap.js?v=1.0.0.54"></script>
<script src="js/admin.js?v=1.0.0.54"></script>
<script src="js/pages/ui/animations.js?v=1.0.0.54"></script>
<script src="js/pages/ui/modals.js?v=1.0.0.54"></script>
<script src="plugins/sweetalert/sweetalert.min.js?v=1.0.0.54"></script>
<script src="js/api.js?v=1.0.0.54"></script>
<script src="js/script.js?v=1.0.0.54"></script>
<script src="js/models/pokedex.js?v=1.0.0.54"></script>
<script src="js/controller/language.js?v=1.0.0.54"></script>
<script src="js/controller/home.js?v=1.0.0.54"></script>
<script src="js/controller/play.js?v=1.0.0.54"></script>
<script src="js/controller/playvars.js?v=1.0.0.54"></script>
<script src="js/controller/playfunctions.js?v=1.0.0.54"></script>
<script src="js/controller/playactions.js?v=1.0.0.54"></script>
<script src="js/controller/pokemon.js?v=1.0.0.54"></script>
<script src="js/joy.min.js?v=1.0.0.54"></script>
<style>

    #main {
        touch-action: auto !important;
    }

    body {
        font-size: 24px !important;
    }

</style>
<script>
    $(document).ready(function () {

        ACTIONS.GAME.PLAY();
        if (createjs.Touch.isSupported()) {
            document.getElementById("arrow_upward").addEventListener('touchstart', function () {
                PADMOVE('w');
            }, {passive: true});
            document.getElementById("arrow_back").addEventListener('touchstart', function () {
                PADMOVE('a');
            }, {passive: true});
            document.getElementById("arrow_downward").addEventListener('touchstart', function () {
                PADMOVE('s');
            }, {passive: true});
            document.getElementById("arrow_forward").addEventListener('touchstart', function () {
                PADMOVE('d');
            }, {passive: true});

            document.getElementById("arrow_upward").addEventListener('touchend', function () {
                PADMOVE('q');
            }, {passive: true});
            document.getElementById("arrow_back").addEventListener('touchend', function () {
                PADMOVE('q');
            }, {passive: true});
            document.getElementById("arrow_downward").addEventListener('touchend', function () {
                PADMOVE('q');
            }, {passive: true});
            document.getElementById("arrow_forward").addEventListener('touchend', function () {
                PADMOVE('q');
            }, {passive: true});
        } else {
            $("#numpads").remove();
        }
    });


    // var conn = new WebSocket('ws://localhost:9090');
    // conn.onopen = function (e) {
    //     console.log("Connection established!");
    // };
    //
    // conn.onmessage = function (e) {
    //     console.log(e.data);
    // };
</script>
<script>
    $(document).ready(function () {
        document.getElementById("footer").style.width = getComputedStyle(document.getElementById("game")).marginLeft - 3;
        document.getElementById("footer2").style.width = getComputedStyle(document.getElementById("game")).marginLeft - 3;
    });
</script>
</body>

</html>
