"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.siblingDep = siblingDep;
exports.default = exports.exactDevDeps = exports.devDeps = exports.deps = void 0;

require("source-map-support/register");

var _asyncOra = require("@electron-forge/async-ora");

var _debug = _interopRequireDefault(require("debug"));

var _fsExtra = _interopRequireDefault(require("fs-extra"));

var _path = _interopRequireDefault(require("path"));

var _installDependencies = _interopRequireWildcard(require("../../util/install-dependencies"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const d = (0, _debug.default)('electron-forge:init:npm');

const corePackage = _fsExtra.default.readJsonSync(_path.default.resolve(__dirname, '../../../package.json'));

function siblingDep(name) {
  return `@electron-forge/${name}@${corePackage.version}`;
}

const deps = ['electron-squirrel-startup'];
exports.deps = deps;
const devDeps = [siblingDep('cli'), siblingDep('maker-squirrel'), siblingDep('maker-zip'), siblingDep('maker-deb'), siblingDep('maker-rpm')];
exports.devDeps = devDeps;
const exactDevDeps = ['electron'];
exports.exactDevDeps = exactDevDeps;

var _default = async dir => {
  await (0, _asyncOra.asyncOra)('Installing NPM Dependencies', async () => {
    d('installing dependencies');
    await (0, _installDependencies.default)(dir, deps);
    d('installing devDependencies');
    await (0, _installDependencies.default)(dir, devDeps, _installDependencies.DepType.DEV);
    d('installing exact devDependencies');

    for (const packageName of exactDevDeps) {
      await (0, _installDependencies.default)(dir, [packageName], _installDependencies.DepType.DEV, _installDependencies.DepVersionRestriction.EXACT);
    }
  });
};

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hcGkvaW5pdC1zY3JpcHRzL2luaXQtbnBtLnRzIl0sIm5hbWVzIjpbImQiLCJjb3JlUGFja2FnZSIsImZzIiwicmVhZEpzb25TeW5jIiwicGF0aCIsInJlc29sdmUiLCJfX2Rpcm5hbWUiLCJzaWJsaW5nRGVwIiwibmFtZSIsInZlcnNpb24iLCJkZXBzIiwiZGV2RGVwcyIsImV4YWN0RGV2RGVwcyIsImRpciIsIkRlcFR5cGUiLCJERVYiLCJwYWNrYWdlTmFtZSIsIkRlcFZlcnNpb25SZXN0cmljdGlvbiIsIkVYQUNUIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7Ozs7Ozs7O0FBRUEsTUFBTUEsQ0FBQyxHQUFHLG9CQUFNLHlCQUFOLENBQVY7O0FBQ0EsTUFBTUMsV0FBVyxHQUFHQyxpQkFBR0MsWUFBSCxDQUFnQkMsY0FBS0MsT0FBTCxDQUFhQyxTQUFiLEVBQXdCLHVCQUF4QixDQUFoQixDQUFwQjs7QUFFTyxTQUFTQyxVQUFULENBQW9CQyxJQUFwQixFQUFrQztBQUN2QyxTQUFRLG1CQUFrQkEsSUFBSyxJQUFHUCxXQUFXLENBQUNRLE9BQVEsRUFBdEQ7QUFDRDs7QUFFTSxNQUFNQyxJQUFJLEdBQUcsQ0FBQywyQkFBRCxDQUFiOztBQUNBLE1BQU1DLE9BQU8sR0FBRyxDQUNyQkosVUFBVSxDQUFDLEtBQUQsQ0FEVyxFQUVyQkEsVUFBVSxDQUFDLGdCQUFELENBRlcsRUFHckJBLFVBQVUsQ0FBQyxXQUFELENBSFcsRUFJckJBLFVBQVUsQ0FBQyxXQUFELENBSlcsRUFLckJBLFVBQVUsQ0FBQyxXQUFELENBTFcsQ0FBaEI7O0FBT0EsTUFBTUssWUFBWSxHQUFHLENBQUMsVUFBRCxDQUFyQjs7O2VBRVEsTUFBT0MsR0FBUCxJQUF1QjtBQUNwQyxRQUFNLHdCQUFTLDZCQUFULEVBQXdDLFlBQVk7QUFDeERiLElBQUFBLENBQUMsQ0FBQyx5QkFBRCxDQUFEO0FBQ0EsVUFBTSxrQ0FBZWEsR0FBZixFQUFvQkgsSUFBcEIsQ0FBTjtBQUVBVixJQUFBQSxDQUFDLENBQUMsNEJBQUQsQ0FBRDtBQUNBLFVBQU0sa0NBQWVhLEdBQWYsRUFBb0JGLE9BQXBCLEVBQTZCRyw2QkFBUUMsR0FBckMsQ0FBTjtBQUVBZixJQUFBQSxDQUFDLENBQUMsa0NBQUQsQ0FBRDs7QUFDQSxTQUFLLE1BQU1nQixXQUFYLElBQTBCSixZQUExQixFQUF3QztBQUN0QyxZQUFNLGtDQUFlQyxHQUFmLEVBQW9CLENBQUNHLFdBQUQsQ0FBcEIsRUFBbUNGLDZCQUFRQyxHQUEzQyxFQUFnREUsMkNBQXNCQyxLQUF0RSxDQUFOO0FBQ0Q7QUFDRixHQVhLLENBQU47QUFZRCxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXN5bmNPcmEgfSBmcm9tICdAZWxlY3Ryb24tZm9yZ2UvYXN5bmMtb3JhJztcbmltcG9ydCBkZWJ1ZyBmcm9tICdkZWJ1Zyc7XG5pbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cbmltcG9ydCBpbnN0YWxsRGVwTGlzdCwgeyBEZXBUeXBlLCBEZXBWZXJzaW9uUmVzdHJpY3Rpb24gfSBmcm9tICcuLi8uLi91dGlsL2luc3RhbGwtZGVwZW5kZW5jaWVzJztcblxuY29uc3QgZCA9IGRlYnVnKCdlbGVjdHJvbi1mb3JnZTppbml0Om5wbScpO1xuY29uc3QgY29yZVBhY2thZ2UgPSBmcy5yZWFkSnNvblN5bmMocGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uLy4uLy4uL3BhY2thZ2UuanNvbicpKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHNpYmxpbmdEZXAobmFtZTogc3RyaW5nKSB7XG4gIHJldHVybiBgQGVsZWN0cm9uLWZvcmdlLyR7bmFtZX1AJHtjb3JlUGFja2FnZS52ZXJzaW9ufWA7XG59XG5cbmV4cG9ydCBjb25zdCBkZXBzID0gWydlbGVjdHJvbi1zcXVpcnJlbC1zdGFydHVwJ107XG5leHBvcnQgY29uc3QgZGV2RGVwcyA9IFtcbiAgc2libGluZ0RlcCgnY2xpJyksXG4gIHNpYmxpbmdEZXAoJ21ha2VyLXNxdWlycmVsJyksXG4gIHNpYmxpbmdEZXAoJ21ha2VyLXppcCcpLFxuICBzaWJsaW5nRGVwKCdtYWtlci1kZWInKSxcbiAgc2libGluZ0RlcCgnbWFrZXItcnBtJyksXG5dO1xuZXhwb3J0IGNvbnN0IGV4YWN0RGV2RGVwcyA9IFsnZWxlY3Ryb24nXTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKGRpcjogc3RyaW5nKSA9PiB7XG4gIGF3YWl0IGFzeW5jT3JhKCdJbnN0YWxsaW5nIE5QTSBEZXBlbmRlbmNpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgZCgnaW5zdGFsbGluZyBkZXBlbmRlbmNpZXMnKTtcbiAgICBhd2FpdCBpbnN0YWxsRGVwTGlzdChkaXIsIGRlcHMpO1xuXG4gICAgZCgnaW5zdGFsbGluZyBkZXZEZXBlbmRlbmNpZXMnKTtcbiAgICBhd2FpdCBpbnN0YWxsRGVwTGlzdChkaXIsIGRldkRlcHMsIERlcFR5cGUuREVWKTtcblxuICAgIGQoJ2luc3RhbGxpbmcgZXhhY3QgZGV2RGVwZW5kZW5jaWVzJyk7XG4gICAgZm9yIChjb25zdCBwYWNrYWdlTmFtZSBvZiBleGFjdERldkRlcHMpIHtcbiAgICAgIGF3YWl0IGluc3RhbGxEZXBMaXN0KGRpciwgW3BhY2thZ2VOYW1lXSwgRGVwVHlwZS5ERVYsIERlcFZlcnNpb25SZXN0cmljdGlvbi5FWEFDVCk7XG4gICAgfVxuICB9KTtcbn07XG4iXX0=